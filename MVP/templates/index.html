<!DOCTYPE html>
<html>
<head>
    <title>RapidAPI Endpoint Tester</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .error {
            color: red;
            margin-top: 10px;
        }
        pre {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>RapidAPI Endpoint Tester</h1>
    
    <form method="POST">
        {{ form.hidden_tag() }}
        
        <div class="form-group">
            {{ form.api_category.label }}
            {{ form.api_category(class="form-control") }}
        </div>
        
        <div class="form-group">
            {{ form.endpoint.label }}
            {{ form.endpoint(class="form-control") }}
        </div>
        
        <!-- Dynamic parameters will be added here -->
        <div id="dynamic-params"></div>
        
        <div class="form-group">
            {{ form.submit(class="btn btn-primary") }}
        </div>
    </form>

    {% if error %}
    <div class="error">{{ error }}</div>
    {% endif %}

    {% if result %}
    <div class="result">
        <h3>API Response:</h3>
        <pre>{{ result|tojson|indent(2) }}</pre>
    </div>
    {% endif %}

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const apiCategory = document.getElementById('{{ form.api_category.id }}');
        const endpoint = document.getElementById('{{ form.endpoint.id }}');
        const dynamicParams = document.getElementById('dynamic-params');

        // Update endpoint options when category changes
        apiCategory.addEventListener('change', function() {
            const selectedCategory = this.value;
            // Clear existing parameters
            dynamicParams.innerHTML = '';
            
            // Get selected endpoint
            const selectedEndpoint = endpoint.value;
            if (selectedCategory && selectedEndpoint) {
                addParameters(selectedCategory, selectedEndpoint);
            }
        });

        // Update parameters when endpoint changes
        endpoint.addEventListener('change', function() {
            const selectedCategory = apiCategory.value;
            const selectedEndpoint = this.value;
            if (selectedCategory && selectedEndpoint) {
                addParameters(selectedCategory, selectedEndpoint);
            }
        });

        function addParameters(category, endpoint) {
            const endpoints = {{ ENDPOINTS|tojson }};
            const params = endpoints[category][endpoint]['params'];
            
            params.forEach(param => {
                let input;
                if (param === 'can_support_threading') {
                    input = `<div class="form-group">
                        <label for="${param}">${param.replace('_', ' ').charAt(0).toUpperCase() + param.slice(1)}:</label>
                        <input type="checkbox" id="${param}" name="${param}" value="true">
                    </div>`;
                } else if (param === 'language') {
                    input = `<div class="form-group">
                        <label for="${param}">${param.replace('_', ' ').charAt(0).toUpperCase() + param.slice(1)}:</label>
                        <select id="${param}" name="${param}">
                            <option value="english">English</option>
                            <option value="spanish">Spanish</option>
                            <option value="french">French</option>
                            <option value="german">German</option>
                        </select>
                    </div>`;
                } else if (param === 'stemmer') {
                    input = `<div class="form-group">
                        <label for="${param}">${param.replace('_', ' ').charAt(0).toUpperCase() + param.slice(1)}:</label>
                        <select id="${param}" name="${param}">
                            <option value="porter">Porter</option>
                            <option value="snowball">Snowball</option>
                        </select>
                    </div>`;
                } else if (param === 'output') {
                    input = `<div class="form-group">
                        <label for="${param}">${param.replace('_', ' ').charAt(0).toUpperCase() + param.slice(1)}:</label>
                        <select id="${param}" name="${param}">
                            <option value="tagged">Tagged</option>
                            <option value="untagged">Untagged</option>
                        </select>
                    </div>`;
                } else {
                    input = `<div class="form-group">
                        <label for="${param}">${param.replace('_', ' ').charAt(0).toUpperCase() + param.slice(1)}:</label>
                        <input type="text" id="${param}" name="${param}" class="form-control">
                    </div>`;
                }
                dynamicParams.innerHTML += input;
            });
        }
    });
    </script>
</body>
</html>
